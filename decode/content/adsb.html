
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1. ADS-B (Automatic Dependent Surveillance – Broadcast) &#8212; The 1090MHz Riddle Book</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. EHS (Mode-S Enhanced Surveillance)" href="ehs.html" />
    <link rel="prev" title="The 1090MHz Riddle" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3><a href="../index.html">The 1090MHz Riddle</a></h3>

A Open book on Mode-S and ADS-B decoding

<br/><br/><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. ADS-B (Automatic Dependent Surveillance – Broadcast)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aircraft-identification">1.2. Aircraft Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compact-position-reporting">1.3. Compact Position Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#airborne-positions">1.4. Airborne Positions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#airborne-velocity">1.5. Airborne Velocity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrity-and-accuracy">1.6. Integrity and Accuracy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ehs.html">2. EHS (Mode-S Enhanced Surveillance)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ehs.html#introduction">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="ehs.html#aircraft-identification-bds-2-0">2.2. Aircraft identification (BDS 2,0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ehs.html#selected-intention-bds-4-0">2.3. Selected intention (BDS 4,0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ehs.html#track-and-turn-bds-5-0">2.4. Track and turn (BDS 5,0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ehs.html#heading-and-speed-bds-6-0">2.5. Heading and speed (BDS 6,0)</a></li>
</ul>
</li>
</ul>


  <br/>
  <h3>Page Source</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/content/adsb.rst.txt"
           rel="nofollow">Show Source</a></li>
  <!--
    <li><a href="https://github.com/junzis/decode-modes/blob/master/content/adsb.rst"
           rel="nofollow">Show on GitHub</a></li> -->
    <li><a href="https://github.com/junzis/decode-modes/edit/master/content/adsb.rst"
           rel="nofollow">Edit on GitHub</a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ads-b-automatic-dependent-surveillance-broadcast">
<h1>1. ADS-B (Automatic Dependent Surveillance – Broadcast)<a class="headerlink" href="#ads-b-automatic-dependent-surveillance-broadcast" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>1.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>ADS-B is short for Automatic Dependent Surveillance–Broadcast. it is a satellite based surveillance system. Aircraft position, velocity, together with identification are transmitted through Mode-S Extended Squitter (1090 MHz).</p>
<p>Majority of the aircraft nowadays are broadcasting ADS-B messages constantly. There are many ways you can set up you own receiver and antenna to start tapping into those signals (DVB-T usb stick, ModeSBeast, Raspberry Pi, RadarScape, etc).</p>
<p>An ADS-B message is 112 bits long, and consist of 5 parts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+--------+--------+-----------+--------------------------+---------+</span>
<span class="o">|</span>  <span class="n">DF</span> <span class="mi">5</span>  <span class="o">|</span>  <span class="o">**</span> <span class="mi">3</span>  <span class="o">|</span>  <span class="n">ICAO</span> <span class="mi">24</span>  <span class="o">|</span>          <span class="n">DATA</span> <span class="mi">56</span>         <span class="o">|</span>  <span class="n">PI</span> <span class="mi">24</span>  <span class="o">|</span>
<span class="o">+-----------------+-----------+--------------------------+---------+</span>
</pre></div>
</div>
<p>This table lists the key bits of a message:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="17%" />
<col width="14%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">nBits</th>
<th class="head">Bits</th>
<th class="head">Abbr.</th>
<th class="head">Name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5</td>
<td>1 - 5</td>
<td>DF</td>
<td>Downlink Format (17 or 18)</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>6 - 8</td>
<td>CA</td>
<td>Capability (additional identifier)</td>
</tr>
<tr class="row-even"><td>24</td>
<td>9- 32</td>
<td>ICAO</td>
<td>ICAO aircraft address</td>
</tr>
<tr class="row-odd"><td rowspan="2">56</td>
<td>33 - 88</td>
<td>DATA</td>
<td>Data</td>
</tr>
<tr class="row-even"><td>[33 - 37]</td>
<td>[TC]</td>
<td>Type code</td>
</tr>
<tr class="row-odd"><td>24</td>
<td>89 - 112</td>
<td>PI</td>
<td>Parity/Interrogator ID</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Raw</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">hexadecimal</span><span class="p">:</span>
<span class="mi">8</span><span class="n">D4840D6202CC371C32CE0576098</span>


<span class="o">-----+------------+--------------+-------------------------------+--------------</span>
<span class="n">HEX</span>  <span class="o">|</span> <span class="mi">8</span><span class="n">D</span>         <span class="o">|</span> <span class="mi">4840</span><span class="n">D6</span>       <span class="o">|</span> <span class="mi">202</span><span class="n">CC371C32CE0</span>                <span class="o">|</span> <span class="mi">576098</span>
<span class="o">-----+------------+--------------+-------------------------------+--------------</span>
<span class="n">BIN</span>  <span class="o">|</span> <span class="mi">10001</span>  <span class="mi">101</span> <span class="o">|</span> <span class="mi">010010000100</span> <span class="o">|</span> <span class="p">[</span><span class="mi">00100</span><span class="p">]</span><span class="mi">0000010110011000011011</span> <span class="o">|</span> <span class="mi">010101110110</span>
     <span class="o">|</span>            <span class="o">|</span> <span class="mi">000011010110</span> <span class="o">|</span> <span class="mi">10001110000110010110011100000</span> <span class="o">|</span> <span class="mi">000010011000</span>
<span class="o">-----+------------+--------------+-------------------------------+--------------</span>
<span class="n">DEC</span>  <span class="o">|</span>  <span class="mi">17</span>    <span class="mi">5</span>   <span class="o">|</span>              <span class="o">|</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">.......................</span>   <span class="o">|</span>
<span class="o">-----+------------+--------------+-------------------------------+--------------</span>
        <span class="n">DF</span>    <span class="n">CA</span>     <span class="n">ICAO</span>          <span class="p">[</span><span class="n">TC</span><span class="p">]</span> <span class="o">------</span> <span class="n">DATA</span> <span class="o">----------</span>    <span class="n">PI</span>
</pre></div>
</div>
<p>Any ADS-B must start with the Downlink Format 17 or 18 (10001 or 10010 in binary code) for the first 5 bits. Bits 6-8 are used as additional identifier, which has different meanings within different types of ADS-B message.</p>
<div class="section" id="ads-b-message-types">
<h3>1.1.1. ADS-B message types<a class="headerlink" href="#ads-b-message-types" title="Permalink to this headline">¶</a></h3>
<p>To identify what information is contained in a ADS-B message. We need to take a look at the <code class="docutils literal"><span class="pre">Type</span> <span class="pre">Code</span></code> of the message, indicated at bits 33 - 37 of the ADS-B message (or first 5 bits of the <code class="docutils literal"><span class="pre">DATA</span></code> segment)</p>
<p>Following are the relationship between each <code class="docutils literal"><span class="pre">Type</span> <span class="pre">Code</span></code> and its information contained in the <code class="docutils literal"><span class="pre">DATA</span></code> segment:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TC</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1 - 4</td>
<td>Aircraft identification</td>
</tr>
<tr class="row-odd"><td>5 - 8</td>
<td>Surface position</td>
</tr>
<tr class="row-even"><td>9 - 18</td>
<td>Airborne position (w/ Baro Altitude)</td>
</tr>
<tr class="row-odd"><td>19</td>
<td>Airborne velocities</td>
</tr>
<tr class="row-even"><td>20 - 22</td>
<td>Airborne position (w/ GNSS Height)</td>
</tr>
<tr class="row-odd"><td>23 - 31</td>
<td>Reserved for other uses</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ads-b-checksum">
<h3>1.1.2. ADS-B Checksum<a class="headerlink" href="#ads-b-checksum" title="Permalink to this headline">¶</a></h3>
<p>ADS-B uses cyclic redundancy check to validate the correctness of received message, where the last 24 bits are the parity bits. Following pseudo-code describes the CRC process:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GENERATOR</span> <span class="o">=</span> <span class="mi">1111111111111010000001001</span>

<span class="n">MSG</span> <span class="o">=</span> <span class="n">binary</span><span class="p">(</span><span class="mi">8</span><span class="n">D4840D6202CC371C32CE0576098</span><span class="p">)</span>    <span class="c1"># 112 bits</span>

<span class="k">for</span> <span class="n">i</span> <span class="kn">from</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">88</span><span class="p">:</span>                           <span class="c1"># 112 bits - 24 parity bits</span>
  <span class="k">if</span> <span class="n">MSG</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">MSG</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">MSG</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">24</span><span class="p">]</span> <span class="o">^</span> <span class="n">GENERATOR</span>

<span class="n">CRC</span> <span class="o">=</span> <span class="n">MSG</span><span class="p">[</span><span class="o">-</span><span class="mi">24</span><span class="p">:]</span>                               <span class="c1"># last 24 bits of result</span>

<span class="n">IF</span> <span class="n">CRC</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
  <span class="n">MSG</span> <span class="ow">is</span> <span class="n">corrupted</span>
</pre></div>
</div>
<p>For the implementation of CRC encoder in python, refer to the pyModeS library function: <code class="docutils literal"><span class="pre">pyModeS.util.crc()</span></code></p>
<p>A comprehensive documentation on Mode-S parity coding can be found:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Gertz</span><span class="p">,</span> <span class="n">Jeffrey</span> <span class="n">L</span><span class="o">.</span> <span class="n">Fundamentals</span> <span class="n">of</span> <span class="n">mode</span> <span class="n">s</span> <span class="n">parity</span> <span class="n">coding</span><span class="o">.</span> <span class="n">No</span><span class="o">.</span> <span class="n">ATC</span><span class="o">-</span><span class="mf">117.</span>
<span class="n">MASSACHUSETTS</span> <span class="n">INST</span> <span class="n">OF</span> <span class="n">TECH</span> <span class="n">LEXINGTON</span> <span class="n">LINCOLN</span> <span class="n">LAB</span><span class="p">,</span> <span class="mf">1984.</span> <span class="n">APA</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aircraft-identification">
<h2>1.2. Aircraft Identification<a class="headerlink" href="#aircraft-identification" title="Permalink to this headline">¶</a></h2>
<p>An aircraft identification message has <code class="docutils literal"><span class="pre">DF:</span> <span class="pre">17</span> <span class="pre">or</span> <span class="pre">18</span></code>, and <code class="docutils literal"><span class="pre">TC:</span> <span class="pre">1</span> <span class="pre">to</span> <span class="pre">4</span></code>, the 56-bit <code class="docutils literal"><span class="pre">DATA</span></code> field is configured as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+</span>
<span class="o">|</span>  <span class="n">TC</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span>  <span class="n">EC</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C1</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C2</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C3</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C4</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C5</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C6</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C7</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>  <span class="n">C8</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+</span>

<span class="n">TC</span><span class="p">:</span> <span class="n">Type</span> <span class="n">code</span>
<span class="n">EC</span><span class="p">:</span> <span class="n">Emitter</span> <span class="n">category</span>
<span class="n">C</span><span class="o">*</span><span class="p">:</span> <span class="n">Charactor</span>
</pre></div>
</div>
<p>For decode charactors, a lookup table is needed for mapping numbers to characters. It is defines as follows, where the <code class="docutils literal"><span class="pre">#</span></code> is not used, and <code class="docutils literal"><span class="pre">_</span></code> represents a sepration.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#ABCDEFGHIJKLMNOPQRSTUVWXYZ#####_###############0123456789######</span>
</pre></div>
</div>
<p>In summary, characters and there decimal reprsentations are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">-</span> <span class="n">Z</span> <span class="p">:</span>   <span class="mi">1</span> <span class="o">-</span> <span class="mi">26</span>
<span class="mi">0</span> <span class="o">-</span> <span class="mi">9</span> <span class="p">:</span>  <span class="mi">48</span> <span class="o">-</span> <span class="mi">57</span>
    <span class="n">_</span> <span class="p">:</span>  <span class="mi">32</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">EC</span></code> value in combination with <code class="docutils literal"><span class="pre">TC</span></code> value defines the category of the aircraft (such as: heavy, large, small, light, glider, etc.). When <code class="docutils literal"><span class="pre">EC</span></code> is set to zeros, such information is not avaiable.</p>
<div class="section" id="example">
<h3>1.2.1. Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">8</span><span class="n">D4840D6202CC371C32CE0576098</span>
</pre></div>
</div>
<p>The structure of the message is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">DF</span><span class="o">---</span> <span class="n">CA</span><span class="o">-</span>  <span class="n">ICAO</span><span class="o">--</span>  <span class="n">DATA</span><span class="o">------------------</span>  <span class="n">PI</span><span class="o">----</span>
<span class="n">HEX</span><span class="p">:</span> <span class="mi">8</span>   <span class="n">D</span>      <span class="mi">4840</span><span class="n">D6</span>  <span class="mi">2</span>   <span class="mi">0</span>     <span class="mi">2</span><span class="n">CC371C32CE0</span>  <span class="mi">576098</span>
<span class="n">BIN</span><span class="p">:</span> <span class="mi">10001</span><span class="o">|</span><span class="mi">101</span>  <span class="o">******</span>  <span class="mi">00100</span><span class="o">|</span><span class="mi">000</span> <span class="o">************</span>  <span class="o">******</span>
<span class="n">DEC</span><span class="p">:</span> <span class="mi">17</span>   <span class="o">|</span><span class="mi">4</span>            <span class="mi">4</span>     <span class="mi">0</span>
                        <span class="n">TC</span>    <span class="o">*</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">Type</span> <span class="pre">Code</span></code> is inside of the DATA frame (first 5 bits). With <code class="docutils literal"><span class="pre">DF=17</span></code> and <code class="docutils literal"><span class="pre">TC=4</span></code>, we can confirm this is a aircraft identification message. Aircraft <code class="docutils literal"><span class="pre">callsign</span></code> then can be decoded.</p>
<p>In previous example message, it is easy to decode the <code class="docutils literal"><span class="pre">Data</span></code> segment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HEX</span><span class="p">:</span> <span class="mi">20</span>         <span class="mi">2</span><span class="n">CC371C32CE0</span>
<span class="n">BIN</span><span class="p">:</span> <span class="mi">00100000</span> <span class="o">|</span> <span class="mi">001011</span> <span class="mi">001100</span> <span class="mi">001101</span> <span class="mi">110001</span> <span class="mi">110000</span> <span class="mi">110010</span> <span class="mi">110011</span> <span class="mi">100000</span>
<span class="n">DEC</span><span class="p">:</span>          <span class="o">|</span>   <span class="mi">11</span>     <span class="mi">12</span>     <span class="mi">13</span>     <span class="mi">49</span>     <span class="mi">48</span>     <span class="mi">50</span>     <span class="mi">51</span>     <span class="mi">32</span>
<span class="n">LTR</span><span class="p">:</span>          <span class="o">|</span>   <span class="n">K</span>      <span class="n">L</span>      <span class="n">M</span>      <span class="mi">1</span>      <span class="mi">0</span>      <span class="mi">2</span>      <span class="mi">3</span>      <span class="n">_</span>
</pre></div>
</div>
<p>So the final aircraft callsign decoded is: <strong>KLM1023_</strong></p>
<p>For detailed codes in python, refer to the pyModeS library function: <code class="docutils literal"><span class="pre">pyModeS.adsb.callsign()</span></code></p>
</div>
</div>
<div class="section" id="compact-position-reporting">
<h2>1.3. Compact Position Reporting<a class="headerlink" href="#compact-position-reporting" title="Permalink to this headline">¶</a></h2>
<p>The position information in ADS-B messages is encoded in a compact position reporting (CPR) format. The general idea behind CPR is to be able to encode more coordinate decimals using less bits. It is achieved by trading global position ambiguity and time with local position accuracy.</p>
<div class="section" id="id1">
<h3>1.3.1. Example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>An easy example to understand the principle behind CPR:</p>
<p>Imaging the world is constructed by 16 grid, which we have divided into two level, each level are encoded with two bits. Higher level in color are <code class="docutils literal"><span class="pre">00</span></code> (yellow), <code class="docutils literal"><span class="pre">01</span></code> (blue), <code class="docutils literal"><span class="pre">10</span></code> (red), <code class="docutils literal"><span class="pre">11</span></code> (green). And within each color grid, the lower levels are also encoded similarly.</p>
<p>Then each grid can be represented as 4 digit from <code class="docutils literal"><span class="pre">0000</span></code> to <code class="docutils literal"><span class="pre">1111</span></code>. Now, we want to describe the movement indicated as the arrows in the green grids <code class="docutils literal"><span class="pre">1100</span> <span class="pre">-&gt;</span> <span class="pre">1101</span></code>, but we only have 3 bits to encode each position.</p>
<a class="reference internal image-reference" href="../_images/illustration-cpr-1.svg"><img alt="../_images/illustration-cpr-1.svg" src="../_images/illustration-cpr-1.svg" width="472px" /></a>
<p>It is easy to see that the high 2 bits appeared in all positions, so we can define a structure to do the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">The</span> <span class="n">last</span> <span class="n">two</span> <span class="n">bits</span> <span class="n">shall</span> <span class="n">represent</span> <span class="n">the</span> <span class="n">local</span> <span class="n">position</span>
<span class="mf">2.</span> <span class="n">The</span> <span class="n">combination</span> <span class="n">of</span> <span class="n">first</span> <span class="n">digit</span> <span class="kn">from</span> <span class="nn">two</span> <span class="n">messages</span> <span class="n">defines</span> <span class="n">the</span> <span class="n">higher</span> <span class="n">grid</span>
</pre></div>
</div>
<p>The then two message can be sent as <code class="docutils literal"><span class="pre">1</span> <span class="pre">00</span> <span class="pre">-&gt;</span> <span class="pre">1</span> <span class="pre">01</span></code></p>
<p>From lower bits <code class="docutils literal"><span class="pre">00</span> <span class="pre">-&gt;</span> <span class="pre">01</span></code>, we have four different possibility of movement as show in dashed arrows, and from the two first bit combination <code class="docutils literal"><span class="pre">11</span></code>, we know the the arrow shall represent the movement in the green grids:</p>
<a class="reference internal image-reference" href="../_images/illustration-cpr-2.svg"><img alt="../_images/illustration-cpr-2.svg" src="../_images/illustration-cpr-2.svg" width="332px" /></a>
</div>
<div class="section" id="the-cpr-and-functions">
<h3>1.3.2. The CPR and functions<a class="headerlink" href="#the-cpr-and-functions" title="Permalink to this headline">¶</a></h3>
<p>The actual CPR algorithm of course is more complicated, but the principle is very similar to previous example. If only one message is given, it is possible to find multiple solutions that are spaced around the world. The combination of two (different types of) messages will yield the final result.</p>
<p>In CPR encoding, the earth is divided in many zones (similar to the grid in previous example). And the encoding algorithm is also more complicated (described in later section). First, we will list some of the parameters and common functions used in the decoding process here.</p>
<div class="section" id="nz">
<h4>1.3.2.1. NZ<a class="headerlink" href="#nz" title="Permalink to this headline">¶</a></h4>
<p>Number of geographic latitude zones between equator and a pole. It is set to <code class="docutils literal"><span class="pre">NZ</span> <span class="pre">=</span> <span class="pre">15</span></code> for Mode-S CPR encoding</p>
</div>
<div class="section" id="floor-x">
<h4>1.3.2.2. floor(x)<a class="headerlink" href="#floor-x" title="Permalink to this headline">¶</a></h4>
<p>the floor function <code class="docutils literal"><span class="pre">floor(x)</span></code> defines as the greatest integer value k, such that <code class="docutils literal"><span class="pre">k&lt;=x</span></code>, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">floor</span><span class="p">(</span><span class="mf">5.6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">floor</span><span class="p">(</span><span class="o">-</span><span class="mf">5.6</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="mod-x-y">
<h4>1.3.2.3. mod(x, y)<a class="headerlink" href="#mod-x-y" title="Permalink to this headline">¶</a></h4>
<p>the modulus function <code class="docutils literal"><span class="pre">mod(x,</span> <span class="pre">y)</span></code> return:</p>
<div class="math">
\[x - y \cdot floor(\frac{x}{y})\]</div>
<p>where <code class="docutils literal"><span class="pre">y</span></code> can not be zero</p>
</div>
<div class="section" id="nl-lat">
<h4>1.3.2.4. NL(lat)<a class="headerlink" href="#nl-lat" title="Permalink to this headline">¶</a></h4>
<p>Denotes the “number of longitude zones” function, given the latitude angle <code class="docutils literal"><span class="pre">lat</span></code>. The returned integer value is constrained within <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">59]</span></code>, calculated as:</p>
<div class="math">
\[\text{NL}(lat) = floor \left( \frac{2 \pi}{\arccos(1 - \frac{1-\cos(\frac{\pi}{2 \cdot \text{NZ}})}{\cos^2(\frac{\pi}{180} \cdot \text{lat})}) } \right)\]</div>
<p>For latitudes that are close to equator or poles, following value is returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="mi">0</span>     <span class="o">-&gt;</span>    <span class="n">NL</span> <span class="o">=</span> <span class="mi">59</span>
<span class="n">lat</span> <span class="o">=</span> <span class="o">+</span><span class="mi">87</span>   <span class="o">-&gt;</span>    <span class="n">NL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">lat</span> <span class="o">=</span> <span class="o">-</span><span class="mi">87</span>   <span class="o">-&gt;</span>    <span class="n">NL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">lat</span> <span class="o">&gt;</span> <span class="o">+</span><span class="mi">87</span>   <span class="o">-&gt;</span>    <span class="n">NL</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lat</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">87</span>   <span class="o">-&gt;</span>    <span class="n">NL</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="airborne-positions">
<h2>1.4. Airborne Positions<a class="headerlink" href="#airborne-positions" title="Permalink to this headline">¶</a></h2>
<p>An aircraft airborne position message has <code class="docutils literal"><span class="pre">DownlinkFormat:</span> <span class="pre">17</span> <span class="pre">or</span> <span class="pre">18</span></code> and <code class="docutils literal"><span class="pre">TypeCode:</span> <span class="pre">from</span> <span class="pre">9</span> <span class="pre">to</span> <span class="pre">18</span></code>.</p>
<p>Messages are composed as following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="14%" />
<col width="14%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">MSG bits</th>
<th class="head"># bits</th>
<th class="head">Abbr</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1-5</td>
<td>5</td>
<td>DF</td>
<td>Downlink format</td>
</tr>
<tr class="row-odd"><td>33-37</td>
<td>5</td>
<td>TC</td>
<td>Type code</td>
</tr>
<tr class="row-even"><td>38-39</td>
<td>2</td>
<td>SS</td>
<td>Surveillance status</td>
</tr>
<tr class="row-odd"><td>40</td>
<td>1</td>
<td>NICsb</td>
<td>NIC supplement-B</td>
</tr>
<tr class="row-even"><td>41-52</td>
<td>12</td>
<td>ALT</td>
<td>Altitude</td>
</tr>
<tr class="row-odd"><td>53</td>
<td>1</td>
<td>T</td>
<td>Time</td>
</tr>
<tr class="row-even"><td>54</td>
<td>1</td>
<td>F</td>
<td>CPR odd/even frame flag</td>
</tr>
<tr class="row-odd"><td>55-71</td>
<td>17</td>
<td>LAT-CPR</td>
<td>Latitude in CPR format</td>
</tr>
<tr class="row-even"><td>72-88</td>
<td>17</td>
<td>LON-CPR</td>
<td>Longitude in CPR format</td>
</tr>
</tbody>
</table>
<p>Two types of the position messages (odd and even frames) are broadcast alternately. There are two different ways to decode an airborne position base on these messages:</p>
<ol class="arabic simple">
<li>Unknown position, using both type of messages (aka. globally unambiguous position)</li>
<li>Knowing previous position, using only one message (aka. locally unambiguous position)</li>
</ol>
<p>Note: The definition of functions <code class="docutils literal"><span class="pre">NL(lat)</span></code>, <code class="docutils literal"><span class="pre">floor(x)</span></code>, and <code class="docutils literal"><span class="pre">mod(x,y)</span></code> are described in CPR chapter</p>
<div class="section" id="globally-unambiguous-position-decoding-with-two-messages">
<h3>1.4.1. Globally unambiguous position (decoding with two messages)<a class="headerlink" href="#globally-unambiguous-position-decoding-with-two-messages" title="Permalink to this headline">¶</a></h3>
<div class="section" id="odd-or-even-message">
<h4>1.4.1.1. odd” or “even” message?<a class="headerlink" href="#odd-or-even-message" title="Permalink to this headline">¶</a></h4>
<p>For each frame, bit 54 determines whether it is an “odd” or “even” frame:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">Even</span> <span class="n">frame</span>
<span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">Odd</span> <span class="n">frame</span>
</pre></div>
</div>
<p>For example, the two following messages are received:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">8</span><span class="n">D40621D58C382D690C8AC2863A7</span>
<span class="mi">8</span><span class="n">D40621D58C386435CC412692AD6</span>

<span class="o">|</span>    <span class="o">|</span> <span class="n">ICAO24</span> <span class="o">|</span>      <span class="n">DATA</span>      <span class="o">|</span>  <span class="n">CRC</span>   <span class="o">|</span>
<span class="o">|----|--------|----------------|--------|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="mi">40621</span><span class="n">D</span> <span class="o">|</span> <span class="mi">58</span><span class="n">C382D690C8AC</span> <span class="o">|</span> <span class="mi">2863</span><span class="n">A7</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="mi">40621</span><span class="n">D</span> <span class="o">|</span> <span class="mi">58</span><span class="n">C386435CC412</span> <span class="o">|</span> <span class="mi">692</span><span class="n">AD6</span> <span class="o">|</span>


<span class="n">Data</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>

<span class="o">|</span> <span class="n">DATA</span>                                                                              <span class="o">|</span>
<span class="o">|===================================================================================|</span>
<span class="o">|</span> <span class="n">TC</span>    <span class="o">|</span> <span class="n">SS</span> <span class="o">|</span> <span class="n">NICsb</span> <span class="o">|</span> <span class="n">ALT</span>          <span class="o">|</span> <span class="n">T</span> <span class="o">|</span> <span class="n">F</span> <span class="o">|</span> <span class="n">CPR</span><span class="o">-</span><span class="n">LAT</span>           <span class="o">|</span> <span class="n">CPR</span><span class="o">-</span><span class="n">LON</span>           <span class="o">|</span>
<span class="o">|-------|----|-------|--------------|---|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">01011</span> <span class="o">|</span> <span class="mi">00</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">110000111000</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">10110101101001000</span> <span class="o">|</span> <span class="mi">01100100010101100</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">01011</span> <span class="o">|</span> <span class="mi">00</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">110000111000</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">10010000110101110</span> <span class="o">|</span> <span class="mi">01100010000010010</span> <span class="o">|</span>
</pre></div>
</div>
<p>In both messages we can find <code class="docutils literal"><span class="pre">DF=17</span></code> and <code class="docutils literal"><span class="pre">TC=11</span></code>, with the same ICAO24 address <code class="docutils literal"><span class="pre">40621D</span></code>. So, those two frames are valid for decoding the positions of this aircraft. Assume the first message is the newest message received.</p>
</div>
<div class="section" id="the-cpr-representation-of-coordinates">
<h4>1.4.1.2. The CPR representation of coordinates<a class="headerlink" href="#the-cpr-representation-of-coordinates" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">F</span> <span class="o">|</span> <span class="n">CPR</span> <span class="n">Latitude</span>      <span class="o">|</span> <span class="n">CPR</span> <span class="n">Longitude</span>     <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">10110101101001000</span> <span class="o">|</span> <span class="mi">01100100010101100</span> <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">newest</span> <span class="n">frame</span> <span class="n">received</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">10010000110101110</span> <span class="o">|</span> <span class="mi">01100010000010010</span> <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>

<span class="n">In</span> <span class="n">decimal</span><span class="p">:</span>

<span class="o">|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">93000</span>             <span class="o">|</span> <span class="mi">51372</span>             <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">74158</span>             <span class="o">|</span> <span class="mi">50194</span>             <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>

<span class="n">CPR_LAT_EVEN</span><span class="p">:</span> <span class="mi">93000</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.7095</span>
<span class="n">CPR_LON_EVEN</span><span class="p">:</span> <span class="mi">51372</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.3919</span>
<span class="n">CPR_LAT_ODD</span><span class="p">:</span>  <span class="mi">74158</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.5658</span>
<span class="n">CPR_LON_ODD</span><span class="p">:</span>  <span class="mi">50194</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.3829</span>
</pre></div>
</div>
<p>Since CPR latitude and longitude are encoded in 17 bits, 131072 (2^17) is the maximum value.</p>
</div>
<div class="section" id="calculate-the-latitude-index-j">
<h4>1.4.1.3. Calculate the latitude index j<a class="headerlink" href="#calculate-the-latitude-index-j" title="Permalink to this headline">¶</a></h4>
<p>Use the following equation:</p>
<div class="math">
\[j = floor \left( 59 \cdot \mathrm{Lat}_\mathrm{cprEven} - 60 \cdot \mathrm{Lat}_\mathrm{cprOdd} + \frac{1}{2}  \right)\]</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-latitude">
<h4>1.4.1.4. Calculate latitude<a class="headerlink" href="#calculate-latitude" title="Permalink to this headline">¶</a></h4>
<p>First, two constants will be used:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\mathrm{dLat}_\mathrm{even} &amp;= \frac{360}{4 \cdot NZ} = \frac{360}{60}\\\mathrm{dLat}_\mathrm{odd} &amp;= \frac{360}{4 \cdot NZ - 1}  = \frac{360}{59}\end{aligned}\end{align} \]</div>
<p>Then we can use the following equations to compute the relative latitudes:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\mathrm{Lat}_\mathrm{even} &amp;= \mathrm{dLat}_\mathrm{even} \cdot [mod(j, 60) + \mathrm{Lat}_\mathrm{cprEven}]\\\mathrm{Lat}_\mathrm{odd} &amp;= \mathrm{dLat}_\mathrm{odd} \cdot [mod(j, 59) + \mathrm{Lat}_\mathrm{cprOdd}]\end{aligned}\end{align} \]</div>
<p>For southern hemisphere, values will fall from 270 to 360 degrees. we need to
make sure the latitude is within range <code class="docutils literal"><span class="pre">[-90,</span> <span class="pre">+90]</span></code>:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\mathrm{Lat}_\mathrm{even} &amp;= \mathrm{Lat}_\mathrm{even} - 360  \quad \text{if } (\mathrm{Lat}_\mathrm{even} \geq 270)\\\mathrm{Lat}_\mathrm{odd} &amp;= \mathrm{Lat}_\mathrm{odd} - 360  \quad \text{if } (\mathrm{Lat}_\mathrm{odd} \geq 270)\end{aligned}\end{align} \]</div>
<p>Final latitude is chosen depending on the time stamp of the frames–the newest one is
used:</p>
<div class="math">
\[\begin{split}\mathrm{Lat} =
\begin{cases}
 \mathrm{Lat}_\mathrm{even}     &amp; \text{if } (T_\mathrm{even} \geq T_\mathrm{odd}) \\
 \mathrm{Lat}_\mathrm{odd}     &amp; \text{else}
\end{cases}\end{split}\]</div>
<p>In the example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Lat_EVEN</span> <span class="o">=</span> <span class="mf">52.25720214843750</span>
<span class="n">Lat_ODD</span>  <span class="o">=</span> <span class="mf">52.26578017412606</span>
<span class="n">Lat</span> <span class="o">=</span> <span class="n">Lat_EVEN</span> <span class="o">=</span> <span class="mf">52.25720</span>
</pre></div>
</div>
</div>
<div class="section" id="check-the-latitude-zone-consistency">
<h4>1.4.1.5. Check the latitude zone consistency<a class="headerlink" href="#check-the-latitude-zone-consistency" title="Permalink to this headline">¶</a></h4>
<p>Compute <code class="docutils literal"><span class="pre">NL(Lat_E)</span></code> and <code class="docutils literal"><span class="pre">NL(Lat_O)</span></code>. If not the same, two positions are located at different latitude zones. Computation of a global longitude is not
possible. exit the calculation and wait for new messages. If two values are the same, we proceed to longitude calculation.</p>
</div>
<div class="section" id="calculate-longitude">
<h4>1.4.1.6. Calculate longitude<a class="headerlink" href="#calculate-longitude" title="Permalink to this headline">¶</a></h4>
<p>If the even frame come latest <code class="docutils literal"><span class="pre">T_EVEN</span> <span class="pre">&gt;</span> <span class="pre">T_ODD</span></code>:</p>
<div class="math">
\[ \begin{align}\begin{aligned}ni &amp;= max \left( NL(\mathrm{Lat}_\mathrm{even}), 1 \right)\\\mathrm{dLon} &amp;= \frac{360}{ni}\\m &amp;= floor \left\{ Lon_\mathrm{cprEven} \cdot [NL(\mathrm{Lat}_\mathrm{even})-1] - Lon_\mathrm{cprOdd} \cdot NL(\mathrm{Lat}_\mathrm{even}) + \frac{1}{2}  \right\}\\\mathrm{Lon} &amp;= \mathrm{dLon} \cdot \left( mod(m, ni) + Lon_\mathrm{cprEven} \right)\end{aligned}\end{align} \]</div>
<p>In case where the odd frame come latest <code class="docutils literal"><span class="pre">T_EVEN</span> <span class="pre">&lt;</span> <span class="pre">T_ODD</span></code>:</p>
<div class="math">
\[ \begin{align}\begin{aligned}ni &amp;= max \left( NL(\mathrm{Lat}_\mathrm{odd})-1, 1 \right)\\\mathrm{dLon} &amp;= \frac{360}{ni}\\m &amp;= floor \left\{ Lon_\mathrm{cprEven} \cdot [NL(\mathrm{Lat}_\mathrm{odd})-1] - Lon_\mathrm{cprOdd} \cdot NL(\mathrm{Lat}_\mathrm{odd}) + \frac{1}{2}  \right\}\\\mathrm{Lon} &amp;= \mathrm{dLon} \cdot \left( mod(m, ni) + Lon_\mathrm{cprOdd} \right)\end{aligned}\end{align} \]</div>
<p>if the result is larger than 180 degrees:</p>
<div class="math">
\[\mathrm{Lon} = \mathrm{Lon} - 360  \quad \text{if } (\mathrm{Lon} \geq 180)\]</div>
<p>In the example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Lon</span><span class="p">:</span>  <span class="mf">3.91937</span>
</pre></div>
</div>
<p>Here is a Python implemented: <a class="reference external" href="https://github.com/junzis/pyModeS/blob/faf4313/pyModeS/adsb.py#L166">https://github.com/junzis/pyModeS/blob/faf4313/pyModeS/adsb.py#L166</a></p>
</div>
<div class="section" id="calculate-altitude">
<h4>1.4.1.7. Calculate altitude<a class="headerlink" href="#calculate-altitude" title="Permalink to this headline">¶</a></h4>
<p>The altitude of the aircraft is much easier to compute from the data frame. The bits in the altitude field (either odd or even frame) are as following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1100001</span> <span class="mi">1</span> <span class="mi">1000</span>
        <span class="o">^</span>
       <span class="n">Q</span><span class="o">-</span><span class="n">bit</span>
</pre></div>
</div>
<p>This Q-bit (bit 48) indicates whether the altitude is encoded in multiples of 25 or 100 ft (0: 100 ft, 1: 25 ft).</p>
<p>For Q = 1, we can calculate the altitude as following:</p>
<p>First, remove the Q-bit</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1100001</span> <span class="mi">1000</span> <span class="o">=&gt;</span> <span class="mi">1560</span> <span class="p">(</span><span class="ow">in</span> <span class="n">decimal</span><span class="p">)</span>
</pre></div>
</div>
<p>The final altitude value will be:</p>
<div class="math">
\[Alt = N \cdot 25 - 1000 \quad \text{(ft.)}\]</div>
<p>In this example, the altitude at which aircraft is flying is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1560</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">-</span> <span class="mi">1000</span> <span class="o">=</span> <span class="mi">38000</span> <span class="n">ft</span><span class="o">.</span>
</pre></div>
</div>
<p>Note that the altitude has the accuracy of +/- 25 ft when the Q-bit is 1, and the value can represent altitude from -1000 to +50175 ft.</p>
</div>
<div class="section" id="the-final-position">
<h4>1.4.1.8. The final position<a class="headerlink" href="#the-final-position" title="Permalink to this headline">¶</a></h4>
<p>Finally, we have all three components (latitude/longitude/altitude) of the aircraft position:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LAT</span><span class="p">:</span> <span class="mf">52.25720</span> <span class="p">(</span><span class="n">degrees</span> <span class="n">N</span><span class="p">)</span>
<span class="n">LON</span><span class="p">:</span>  <span class="mf">3.91937</span> <span class="p">(</span><span class="n">degrees</span> <span class="n">E</span><span class="p">)</span>
<span class="n">ALT</span><span class="p">:</span>    <span class="mi">38000</span> <span class="n">ft</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="locally-unambiguous-position-decoding-with-one-message">
<h3>1.4.2. Locally unambiguous position (decoding with one message)<a class="headerlink" href="#locally-unambiguous-position-decoding-with-one-message" title="Permalink to this headline">¶</a></h3>
<p>This method gives the possibility of decoding aircraft using only one message knowing a reference position. This method compute the latitude index (j) and longitude index (m) based on such reference, and can be used with either type of the messages.</p>
<div class="section" id="the-reference-position">
<h4>1.4.2.1. The reference position<a class="headerlink" href="#the-reference-position" title="Permalink to this headline">¶</a></h4>
<p>The reference position should be close to the actual position (eg. position of aircraft previously decoded, or the location of ADS-B antenna), and must be <strong>within 180 NM</strong> range.</p>
</div>
<div class="section" id="calculate-dlat">
<h4>1.4.2.2. Calculate dLat<a class="headerlink" href="#calculate-dlat" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}dLat =
\begin{cases}
 \frac{360}{4 \cdot NZ} = \frac{360}{60}          &amp; \text{if even message}  \\
 \frac{360}{4 \cdot NZ - 1}  = \frac{360}{59}     &amp; \text{if odd message}
\end{cases}\end{split}\]</div>
</div>
<div class="section" id="id2">
<h4>1.4.2.3. Calculate the latitude index j<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[j = floor \left (\frac{\mathrm{Lat}_{ref}}{dLat} \right) + floor \left( \frac{mod(\mathrm{Lat}_{ref}, dLat)}{dLat}  - \mathrm{Lat}_\mathrm{cpr}  + \frac{1}{2} \right)\]</div>
</div>
<div class="section" id="id3">
<h4>1.4.2.4. Calculate latitude<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\mathrm{Lat} = dLat \cdot (j + \mathrm{Lat}_\mathrm{cpr})\]</div>
</div>
<div class="section" id="calculate-dlon">
<h4>1.4.2.5. Calculate dLon<a class="headerlink" href="#calculate-dlon" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}\mathrm{dLon} =
\begin{cases}
 \frac{360}{NL(Lat)}    &amp; \text{if } NL(Lat) &gt; 0  \\
 360                    &amp; \text{if } NL(Lat) = 0
\end{cases}\end{split}\]</div>
</div>
<div class="section" id="calculate-longitude-index-m">
<h4>1.4.2.6. Calculate longitude index m<a class="headerlink" href="#calculate-longitude-index-m" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[m = floor \left( \frac{Lon_{ref}}{\mathrm{dLon}} \right) + floor \left( \frac{mod(Lon_{ref}, \mathrm{dLon})}{\mathrm{dLon}}  - Lon_\mathrm{cpr}  + \frac{1}{2}  \right)\]</div>
</div>
<div class="section" id="id4">
<h4>1.4.2.7. Calculate longitude<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[Lon = \mathrm{dLon} \cdot (m + Lon_\mathrm{cpr})\]</div>
</div>
<div class="section" id="id5">
<h4>1.4.2.8. Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>For the same example message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">8</span><span class="n">D40621D58C382D690C8AC2863A7</span>

<span class="n">Reference</span> <span class="n">position</span><span class="p">:</span>
  <span class="n">LAT</span><span class="p">:</span> <span class="mf">52.258</span>
  <span class="n">LON</span><span class="p">:</span>  <span class="mf">3.918</span>
</pre></div>
</div>
<p>The structure of message is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">8</span><span class="n">D40621D58C382D690C8AC2863A7</span>

<span class="o">|</span>    <span class="o">|</span> <span class="n">ICAO24</span> <span class="o">|</span>      <span class="n">DATA</span>      <span class="o">|</span>  <span class="n">CRC</span>   <span class="o">|</span>
<span class="o">|----|--------|----------------|--------|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="mi">40621</span><span class="n">D</span> <span class="o">|</span> <span class="mi">58</span><span class="n">C382D690C8AC</span> <span class="o">|</span> <span class="mi">2863</span><span class="n">A7</span> <span class="o">|</span>


<span class="n">Data</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>

<span class="o">|</span> <span class="n">DATA</span>                                                                              <span class="o">|</span>
<span class="o">|===================================================================================|</span>
<span class="o">|</span> <span class="n">TC</span>    <span class="o">|</span> <span class="n">SS</span> <span class="o">|</span> <span class="n">NICsb</span> <span class="o">|</span> <span class="n">ALT</span>          <span class="o">|</span> <span class="n">T</span> <span class="o">|</span> <span class="n">F</span> <span class="o">|</span> <span class="n">CPR</span><span class="o">-</span><span class="n">LAT</span>           <span class="o">|</span> <span class="n">CPR</span><span class="o">-</span><span class="n">LON</span>           <span class="o">|</span>
<span class="o">|-------|----|-------|--------------|---|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">01011</span> <span class="o">|</span> <span class="mi">00</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">110000111000</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">10110101101001000</span> <span class="o">|</span> <span class="mi">01100100010101100</span> <span class="o">|</span>


<span class="n">CPR</span> <span class="n">representation</span><span class="p">:</span>

<span class="o">|</span> <span class="n">F</span> <span class="o">|</span> <span class="n">CPR</span> <span class="n">Latitude</span>      <span class="o">|</span> <span class="n">CPR</span> <span class="n">Longitude</span>     <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">10110101101001000</span> <span class="o">|</span> <span class="mi">01100100010101100</span> <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>

<span class="n">In</span> <span class="n">decimal</span><span class="p">:</span>

<span class="o">|---|-------------------|-------------------|</span>
<span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">93000</span>             <span class="o">|</span> <span class="mi">51372</span>             <span class="o">|</span>
<span class="o">|---|-------------------|-------------------|</span>

<span class="n">CPR_LAT</span><span class="p">:</span> <span class="mi">93000</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.7095</span>
<span class="n">CPR_LON</span><span class="p">:</span> <span class="mi">51372</span> <span class="o">/</span> <span class="mi">131072</span> <span class="o">-&gt;</span> <span class="mf">0.3919</span>
</pre></div>
</div>
<p>Run the calculation, the same result will be decoded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">d_lat</span><span class="p">:</span>  <span class="mi">6</span>
<span class="n">j</span><span class="p">:</span>      <span class="mi">8</span>
<span class="n">lat</span><span class="p">:</span>    <span class="mf">52.25720</span>
<span class="n">m</span><span class="p">:</span>      <span class="mi">0</span>
<span class="n">d_lon</span><span class="p">:</span>  <span class="mi">10</span>
<span class="n">lon</span><span class="p">:</span>    <span class="mf">3.91937</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="airborne-velocity">
<h2>1.5. Airborne Velocity<a class="headerlink" href="#airborne-velocity" title="Permalink to this headline">¶</a></h2>
<p>There are two different types of messages for velocities, determined by  3-bit subtype in the message. With subtype 1 and 2, surface velocity  (ground speed) is reported. And in subtype 3 and 4, aircraft airspeed are reported.</p>
<p>Type 2 and 4 are for supersonic aircraft. So, before we have another commercial supersonic aircraft flying around, you won’t see any of those types.</p>
<p>In real world, very few of subtype 3 messages are reported. In our setup, we only received <strong>0.3%</strong> of these message with regard to subtype 1.</p>
<p>An aircraft velocity message has <code class="docutils literal"><span class="pre">DF:</span> <span class="pre">17</span> <span class="pre">or</span> <span class="pre">18</span></code>, <code class="docutils literal"><span class="pre">TC:</span> <span class="pre">19</span></code>. and the subtype code are represented in bits 38 to 40. Now, we can decode those messages.</p>
<div class="section" id="subtype-1-ground-speed">
<h3>1.5.1. Subtype 1 (Ground Speed)<a class="headerlink" href="#subtype-1-ground-speed" title="Permalink to this headline">¶</a></h3>
<p>Subtype 1 (subsonic, ground speed), are broadcast when ground velocity information are available. The aircraft velocity contains speed and heading information. The speed and heading are also decomposed into North-South, and East-West components.</p>
<p>For example, following message is received:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Message</span><span class="p">:</span> <span class="mi">8</span><span class="n">D485020994409940838175B284F</span>

<span class="o">|</span>    <span class="o">|</span> <span class="n">ICAO24</span> <span class="o">|</span>      <span class="n">DATA</span>      <span class="o">|</span>  <span class="n">CRC</span>   <span class="o">|</span>
<span class="o">|----|--------|----------------|--------|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="mi">485020</span> <span class="o">|</span> <span class="mi">99440994083817</span> <span class="o">|</span> <span class="mi">5</span><span class="n">B284F</span> <span class="o">|</span>

<span class="n">Convert</span> <span class="n">DATA</span> <span class="p">[</span><span class="mi">99440994083817</span><span class="p">]</span> <span class="n">into</span> <span class="n">binary</span><span class="p">:</span>

<span class="o">|-------|-----|----|--------|-----|------|------------|------|------------|-------|------|-----------|--------|-------|---------|</span>
<span class="o">|</span>  <span class="n">TC</span>   <span class="o">|</span> <span class="n">ST</span>  <span class="o">|</span> <span class="n">IC</span> <span class="o">|</span> <span class="n">RESV_A</span> <span class="o">|</span> <span class="n">NAC</span> <span class="o">|</span> <span class="n">S</span><span class="o">-</span><span class="n">EW</span> <span class="o">|</span> <span class="n">V</span><span class="o">-</span><span class="n">EW</span>       <span class="o">|</span> <span class="n">S</span><span class="o">-</span><span class="n">NS</span> <span class="o">|</span> <span class="n">V</span><span class="o">-</span><span class="n">NS</span>       <span class="o">|</span> <span class="n">VrSrc</span> <span class="o">|</span> <span class="n">S</span><span class="o">-</span><span class="n">Vr</span> <span class="o">|</span> <span class="n">Vr</span>        <span class="o">|</span> <span class="n">RESV_B</span> <span class="o">|</span> <span class="n">S_Dif</span> <span class="o">|</span> <span class="n">Dif</span>     <span class="o">|</span>
<span class="o">|-------|-----|----|--------|-----|------|------------|------|------------|-------|------|-----------|--------|-------|---------|</span>
<span class="o">|</span> <span class="mi">10011</span> <span class="o">|</span> <span class="mi">001</span> <span class="o">|</span> <span class="mi">0</span>  <span class="o">|</span> <span class="mi">1</span>      <span class="o">|</span> <span class="mi">000</span> <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">0000001001</span> <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">0010100000</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">000001110</span> <span class="o">|</span> <span class="mi">00</span>     <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">0010111</span> <span class="o">|</span>
</pre></div>
</div>
<p>There are quite a few parameters in the the velocity message. From left to rights, the number of bits indicate the following contents:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="9%" />
<col width="12%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">MSG Bits</th>
<th class="head">DATA Bits</th>
<th class="head">Len</th>
<th class="head">Abbr</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>33-37</td>
<td>1-5</td>
<td>5</td>
<td>TC</td>
<td>Type code</td>
</tr>
<tr class="row-odd"><td>38-40</td>
<td>6-8</td>
<td>3</td>
<td>ST</td>
<td>Subtype</td>
</tr>
<tr class="row-even"><td>41</td>
<td>9</td>
<td>1</td>
<td>IC</td>
<td>Intent change flag</td>
</tr>
<tr class="row-odd"><td>42</td>
<td>10</td>
<td>1</td>
<td>RESV_A</td>
<td>Reserved-A</td>
</tr>
<tr class="row-even"><td>43-45</td>
<td>11-13</td>
<td>3</td>
<td>NAC</td>
<td>Velocity uncertainty (NAC)</td>
</tr>
<tr class="row-odd"><td>46</td>
<td>14</td>
<td>1</td>
<td>S_ew</td>
<td>East-West velocity sign</td>
</tr>
<tr class="row-even"><td>47-56</td>
<td>15-24</td>
<td>10</td>
<td>V_ew</td>
<td>East-West velocity</td>
</tr>
<tr class="row-odd"><td>57</td>
<td>25</td>
<td>1</td>
<td>S_ns</td>
<td>North-South velocity sign</td>
</tr>
<tr class="row-even"><td>58-67</td>
<td>26-35</td>
<td>10</td>
<td>V_ns</td>
<td>North-South velocity</td>
</tr>
<tr class="row-odd"><td>68</td>
<td>36</td>
<td>1</td>
<td>VrSrc</td>
<td>Vertical rate source</td>
</tr>
<tr class="row-even"><td>69</td>
<td>37</td>
<td>1</td>
<td>S_vr</td>
<td>Vertical rate sign</td>
</tr>
<tr class="row-odd"><td>70-78</td>
<td>38-46</td>
<td>9</td>
<td>Vr</td>
<td>Vertical rate</td>
</tr>
<tr class="row-even"><td>79-80</td>
<td>47-48</td>
<td>2</td>
<td>RESV_B</td>
<td>Reserved-B</td>
</tr>
<tr class="row-odd"><td>81</td>
<td>49</td>
<td>1</td>
<td>S_Dif</td>
<td>Diff from baro alt, sign</td>
</tr>
<tr class="row-even"><td>82-88</td>
<td>50-66</td>
<td>7</td>
<td>Dif</td>
<td>Diff from baro alt</td>
</tr>
</tbody>
</table>
<div class="section" id="horizontal-velocity">
<h4>1.5.1.1. Horizontal Velocity<a class="headerlink" href="#horizontal-velocity" title="Permalink to this headline">¶</a></h4>
<p>For calculating the horizontal speed and heading we need four values, East-West Velocity <code class="docutils literal"><span class="pre">V_ew</span></code>, East-West Velocity Sign <code class="docutils literal"><span class="pre">S_ew</span></code>, North-South Velocity <code class="docutils literal"><span class="pre">V_ns</span></code>, North-South Velocity Sign <code class="docutils literal"><span class="pre">S_ns</span></code>. And pay attention on the directions (signs) in the calculation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">S_ns</span><span class="p">:</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">flying</span> <span class="n">North</span> <span class="n">to</span> <span class="n">South</span>
    <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">flying</span> <span class="n">South</span> <span class="n">to</span> <span class="n">North</span>
<span class="n">S_ew</span><span class="p">:</span>
    <span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">flying</span> <span class="n">East</span> <span class="n">to</span> <span class="n">West</span>
    <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">flying</span> <span class="n">West</span> <span class="n">to</span> <span class="n">East</span>
</pre></div>
</div>
<p>The Speed (v) and heading (h) with unit <cite>knot</cite> and <cite>degree</cite> can be computed as follows:</p>
<div class="math">
\[\begin{split}V_{we} =
\begin{cases}
 -1 \cdot (V_{ew} - 1)    &amp; \text{if } s_{ew} = 1 \\
 V_{ew} - 1         &amp; \text{if } s_{ew} = 0
\end{cases}\end{split}\]</div>
<div class="math">
\[\begin{split}V_{sn} =
\begin{cases}
 -1 \cdot (V_{ns} - 1)    &amp; \text{if } s_{ns} = 1 \\
 V_{ns} - 1         &amp; \text{if } s_{ns} = 0
\end{cases}\end{split}\]</div>
<div class="math">
\[v = \sqrt{V_{we}^{2} + V_{sn}^{2}}\]</div>
<div class="math">
\[h = arctan2 \left( V_{we}, V_{sn} \right) \cdot \frac{360}{2\pi}  \quad \text{(deg)}\]</div>
<p>In case of an negative value here, we will simply add 360 degrees.</p>
<div class="math">
\[h = h + 360  \quad (\text{if } h &lt; 0)\]</div>
<p>So, now we have the speed and heading of our example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">-</span><span class="n">EW</span><span class="p">:</span> <span class="mi">0000001001</span> <span class="o">-&gt;</span> <span class="mi">9</span>
<span class="n">S</span><span class="o">-</span><span class="n">EW</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">V</span><span class="o">-</span><span class="n">NS</span><span class="p">:</span> <span class="mi">0010100000</span> <span class="o">-&gt;</span> <span class="mi">160</span>
<span class="n">S</span><span class="o">-</span><span class="n">NS</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">V_</span><span class="p">{</span><span class="n">we</span><span class="p">}</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
<span class="n">V_</span><span class="p">{</span><span class="n">sn</span><span class="p">}</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">160</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">159</span>

<span class="n">v</span> <span class="o">=</span> <span class="mf">159.20</span> <span class="p">(</span><span class="n">kt</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">182.88</span> <span class="p">(</span><span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="vertical-rate">
<h4>1.5.1.2. Vertical Rate<a class="headerlink" href="#vertical-rate" title="Permalink to this headline">¶</a></h4>
<p>The direction of vertical movement of aircraft can be read from <code class="docutils literal"><span class="pre">S_vr</span></code> field, in message bit-69:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">UP</span>
<span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">Down</span>
</pre></div>
</div>
<p>The actual vertical rate <code class="docutils literal"><span class="pre">Vr</span></code> is the value of bits 70-78, minus 1, and then multiplied by 64 in <strong>feet/minute</strong> (ft/min). In our example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Vr</span><span class="o">-</span><span class="n">bits</span><span class="p">:</span> <span class="mi">000001110</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">Vr</span><span class="p">:</span> <span class="p">(</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">x</span> <span class="mi">64</span> <span class="o">=&gt;</span> <span class="mi">832</span> <span class="n">fpm</span>
<span class="n">S</span><span class="o">-</span><span class="n">Vr</span><span class="p">:</span> <span class="mi">0</span> <span class="o">=&gt;</span> <span class="n">Down</span> <span class="o">/</span> <span class="n">Descending</span>
</pre></div>
</div>
<p>So we see a descending aircraft at 832 ft/min rate of descend.</p>
<p>The Vertical Rate Source (VrSrc) field determine whether if it is a measurement in barometric pressure altitude or geometric altitude:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span>  <span class="n">Baro</span><span class="o">-</span><span class="n">pressure</span> <span class="n">altitude</span> <span class="n">change</span> <span class="n">rate</span>
<span class="mi">1</span> <span class="o">-&gt;</span>  <span class="n">Geometric</span> <span class="n">altitude</span> <span class="n">change</span> <span class="n">rate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subtype-3-airspeed">
<h3>1.5.2. Subtype 3 (Airspeed)<a class="headerlink" href="#subtype-3-airspeed" title="Permalink to this headline">¶</a></h3>
<p>Subtype 3 (subsonic, aripseed), are broadcast when ground speed information are NOT available, while airspeed is available. The structure of the message is similar to previous one. Let’s take a close look at an example for decoding here.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Message</span><span class="p">:</span> <span class="mi">8</span><span class="n">DA05F219B06B6AF189400CBC33F</span>

<span class="o">|</span>    <span class="o">|</span> <span class="n">ICAO24</span> <span class="o">|</span>      <span class="n">DATA</span>      <span class="o">|</span>  <span class="n">CRC</span>   <span class="o">|</span>
<span class="o">|----|--------|----------------|--------|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="n">A05F21</span> <span class="o">|</span> <span class="mi">9</span><span class="n">B06B6AF189400</span> <span class="o">|</span> <span class="n">CBC33F</span> <span class="o">|</span>

<span class="n">Convert</span> <span class="n">DATA</span> <span class="p">[</span><span class="mi">9</span><span class="n">B06B6AF189400</span><span class="p">]</span> <span class="n">into</span> <span class="n">binary</span><span class="p">:</span>

<span class="o">|-------|-----|----|--------|-----|------|------------|------|------------|-------|------|-----------|--------|-------|---------|</span>
<span class="o">|</span>  <span class="n">TC</span>   <span class="o">|</span> <span class="n">ST</span>  <span class="o">|</span> <span class="n">IC</span> <span class="o">|</span> <span class="n">RESV_A</span> <span class="o">|</span> <span class="n">NAC</span> <span class="o">|</span> <span class="n">S_hdg</span><span class="o">|</span> <span class="n">Hdg</span>        <span class="o">|</span> <span class="n">AS</span><span class="o">-</span><span class="n">t</span> <span class="o">|</span> <span class="n">AS</span>         <span class="o">|</span> <span class="n">VrSrc</span> <span class="o">|</span> <span class="n">S</span><span class="o">-</span><span class="n">Vr</span> <span class="o">|</span> <span class="n">Vr</span>        <span class="o">|</span> <span class="n">RESV_B</span> <span class="o">|</span> <span class="n">S_Dif</span> <span class="o">|</span> <span class="n">Dif</span>     <span class="o">|</span>
<span class="o">|-------|-----|----|--------|-----|------|------------|------|------------|-------|------|-----------|--------|-------|---------|</span>
<span class="o">|</span> <span class="mi">10011</span> <span class="o">|</span> <span class="mi">011</span> <span class="o">|</span> <span class="mi">0</span>  <span class="o">|</span> <span class="mi">0</span>      <span class="o">|</span> <span class="mi">000</span> <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">1010110110</span> <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">0101111000</span> <span class="o">|</span> <span class="mi">1</span>     <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">000100101</span> <span class="o">|</span> <span class="mi">00</span>     <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">0000000</span> <span class="o">|</span>
</pre></div>
</div>
<p>The detail bits representations are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="9%" />
<col width="11%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">MSG Bits</th>
<th class="head">DATA Bits</th>
<th class="head">Len</th>
<th class="head">Abbr</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>33-37</td>
<td>1-5</td>
<td>5</td>
<td>TC</td>
<td>Type code</td>
</tr>
<tr class="row-odd"><td>38-40</td>
<td>6-8</td>
<td>3</td>
<td>ST</td>
<td>Subtype</td>
</tr>
<tr class="row-even"><td>41</td>
<td>9</td>
<td>1</td>
<td>IC</td>
<td>Intent change flag</td>
</tr>
<tr class="row-odd"><td>42</td>
<td>10</td>
<td>1</td>
<td>RESV_A</td>
<td>Reserved-A</td>
</tr>
<tr class="row-even"><td>43-45</td>
<td>11-13</td>
<td>3</td>
<td>NAC</td>
<td>Velocity uncertainty (NAC)</td>
</tr>
<tr class="row-odd"><td>46</td>
<td>14</td>
<td>1</td>
<td>S_hdg</td>
<td>Heading status</td>
</tr>
<tr class="row-even"><td>47-56</td>
<td>15-24</td>
<td>10</td>
<td>Hdg</td>
<td>Heading (proportion)</td>
</tr>
<tr class="row-odd"><td>57</td>
<td>25</td>
<td>1</td>
<td>AS-t</td>
<td>Airspeed Type</td>
</tr>
<tr class="row-even"><td>58-67</td>
<td>26-35</td>
<td>10</td>
<td>AS</td>
<td>Airspeed</td>
</tr>
<tr class="row-odd"><td>68</td>
<td>36</td>
<td>1</td>
<td>VrSrc</td>
<td>Vertical rate source</td>
</tr>
<tr class="row-even"><td>69</td>
<td>37</td>
<td>1</td>
<td>S_vr</td>
<td>Vertical rate sign</td>
</tr>
<tr class="row-odd"><td>70-78</td>
<td>38-46</td>
<td>9</td>
<td>Vr</td>
<td>Vertical rate</td>
</tr>
<tr class="row-even"><td>79-80</td>
<td>47-48</td>
<td>2</td>
<td>RESV_B</td>
<td>Reserved-B</td>
</tr>
<tr class="row-odd"><td>81</td>
<td>49</td>
<td>1</td>
<td>S_Dif</td>
<td>Difference from baro alt, sign</td>
</tr>
<tr class="row-even"><td>82-88</td>
<td>50-66</td>
<td>7</td>
<td>Dif</td>
<td>Difference from baro alt</td>
</tr>
</tbody>
</table>
<div class="section" id="heading">
<h4>1.5.2.1. Heading<a class="headerlink" href="#heading" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">S_hdg</span></code> makes the status of heading data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">heading</span> <span class="n">data</span> <span class="ow">not</span> <span class="n">available</span>
<span class="mi">1</span> <span class="o">-&gt;</span> <span class="n">heading</span> <span class="n">data</span> <span class="n">available</span>
</pre></div>
</div>
<p>10-bits <code class="docutils literal"><span class="pre">Hdg</span></code> is the represent the proportion of the degrees of a full circle, i.e. 360 degrees. (Note: 0000000000 - 1111111111 represents 0 - 1023 )</p>
<div class="math">
\[heading = Decimal(Hdg) / 1024 * 360^o\]</div>
<p>in our example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1010110110</span> <span class="o">-&gt;</span> <span class="mi">694</span>
<span class="n">heading</span> <span class="o">=</span> <span class="mi">694</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">=</span> <span class="mf">243.98</span> <span class="p">(</span><span class="n">degree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="velocity-airspeed">
<h4>1.5.2.2. Velocity (Airspeed)<a class="headerlink" href="#velocity-airspeed" title="Permalink to this headline">¶</a></h4>
<p>To find out which type of the airspeed (TAS or IAS), first we need to look at the <code class="docutils literal"><span class="pre">AS-t</span></code> field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">Indicated</span> <span class="n">Airspeed</span> <span class="p">(</span><span class="n">IAS</span><span class="p">)</span>
<span class="mi">1</span> <span class="o">-&gt;</span> <span class="kc">True</span> <span class="n">Airspeed</span> <span class="p">(</span><span class="n">TAS</span><span class="p">)</span>
</pre></div>
</div>
<p>And the the speed is simply a binary to decimal conversion of <code class="docutils literal"><span class="pre">AS</span></code> bits (in knot). In our example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0101111000</span> <span class="o">-&gt;</span> <span class="mi">376</span> <span class="n">knot</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h4>1.5.2.3. Vertical Rate<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The vertical rate decoding remains the same as subtype 1.</p>
</div>
</div>
</div>
<div class="section" id="integrity-and-accuracy">
<h2>1.6. Integrity and Accuracy<a class="headerlink" href="#integrity-and-accuracy" title="Permalink to this headline">¶</a></h2>
<p>NIC, NAC, NUC, and SIL, those acronyms do sound confusing. They are measurement
for the integrity,  accuracy, or uncertainties of the position measurement from
GPS unit.</p>
<ul class="simple">
<li>NIC - Navigation Integrity Category</li>
<li>NUC - Navigation Uncertainty Category</li>
<li>NAC - Navigation Accuracy Category</li>
<li>SIL - Surveillance/Source Integrity Level</li>
</ul>
<p>Two of those values are more interesting for us, <code class="docutils literal"><span class="pre">NICp</span></code> and <code class="docutils literal"><span class="pre">NACv</span></code>,
represent the position integrity and velocity accuracy respectively.</p>
<p>Before dive into decoding and interpolation, let’s introduce two parameters:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Rc</span></code>: Horizontal Containment Radius Limit, interpolated from <code class="docutils literal"><span class="pre">NICp</span></code> number</li>
<li><code class="docutils literal"><span class="pre">HFOM</span></code>: Horizontal Figure of Merit, interpolated from <code class="docutils literal"><span class="pre">NACv</span></code> number</li>
</ul>
<div class="section" id="nic-and-rc">
<h3>1.6.1. NIC and Rc<a class="headerlink" href="#nic-and-rc" title="Permalink to this headline">¶</a></h3>
<p>Bring back the message from position decoding previously:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MSG</span><span class="p">:</span> <span class="mi">8</span><span class="n">D40621D58C382D690C8AC2863A7</span>

<span class="o">|</span>    <span class="o">|</span> <span class="n">ICAO24</span> <span class="o">|</span>      <span class="n">DATA</span>      <span class="o">|</span>        <span class="o">|</span>
<span class="o">|----|--------|----------------|--------|</span>
<span class="o">|</span> <span class="mi">8</span><span class="n">D</span> <span class="o">|</span> <span class="mi">40621</span><span class="n">D</span> <span class="o">|</span> <span class="mi">58</span><span class="n">C382D690C8AC</span> <span class="o">|</span> <span class="mi">2863</span><span class="n">A7</span> <span class="o">|</span>
</pre></div>
</div>
<p>Convert both messages to binary strings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">DF</span>    <span class="o">|</span> <span class="n">CA</span>  <span class="o">|</span> <span class="n">ICAO24</span> <span class="n">ADDRESS</span>           <span class="o">|</span> <span class="n">DATA</span>                                   <span class="o">-&gt;</span>
<span class="o">|</span>                                        <span class="o">|</span> <span class="n">TC</span>    <span class="o">|</span> <span class="n">SS</span> <span class="o">|</span> <span class="n">SBnic</span> <span class="o">|</span> <span class="n">Altitude</span>     <span class="o">|</span> <span class="n">T</span>  <span class="o">-&gt;</span>
<span class="o">|-------|-----|--------------------------|-------|----|-------|--------------|---</span> <span class="o">-&gt;</span>
<span class="o">|</span> <span class="mi">10001</span> <span class="o">|</span> <span class="mi">101</span> <span class="o">|</span> <span class="mi">010000000110001000011101</span> <span class="o">|</span> <span class="mi">01011</span> <span class="o">|</span> <span class="mi">00</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">110000111000</span> <span class="o">|</span> <span class="mi">0</span>  <span class="o">-&gt;</span>

  <span class="o">-&gt;</span>  <span class="n">Data</span> <span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="p">)</span>                                   <span class="o">|</span> <span class="n">CRC</span>                      <span class="o">|</span>
  <span class="o">-&gt;</span> <span class="o">|</span> <span class="n">CPR</span><span class="o">-</span><span class="n">F</span> <span class="o">|</span> <span class="n">CPR</span> <span class="n">Latitude</span>      <span class="o">|</span> <span class="n">CPR</span> <span class="n">Longitude</span>     <span class="o">|</span>                          <span class="o">|</span>
  <span class="o">-&gt;</span> <span class="o">|-------|-------------------|-------------------|--------------------------|</span>
  <span class="o">-&gt;</span> <span class="o">|</span> <span class="mi">0</span>     <span class="o">|</span> <span class="mi">10110101101001000</span> <span class="o">|</span> <span class="mi">01100100010101100</span> <span class="o">|</span> <span class="mi">001010000110001110100111</span> <span class="o">|</span>
</pre></div>
</div>
<p>Not the *2 field (<code class="docutils literal"><span class="pre">bit-40</span></code>), where we have the NIC Supplement-B (S[B]) in
combination with TC number, we are able to determine the NIC value.</p>
<p>The relation of TC, NIC, and Rc are as follow:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="18%" />
<col width="13%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TC</th>
<th class="head">SBnic</th>
<th class="head">NIC</th>
<th class="head">Rc</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>9</td>
<td>0</td>
<td>11</td>
<td>&lt; 7.5 m</td>
</tr>
<tr class="row-odd"><td>10</td>
<td>0</td>
<td>10</td>
<td>&lt; 25 m</td>
</tr>
<tr class="row-even"><td rowspan="2">11</td>
<td>1</td>
<td>9</td>
<td>&lt; 74 m</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>8</td>
<td>&lt; 0.1 NM (185 m)</td>
</tr>
<tr class="row-even"><td>12</td>
<td>0</td>
<td>7</td>
<td>&lt; 0.2 NM (370 m)</td>
</tr>
<tr class="row-odd"><td rowspan="3">13</td>
<td>1 *</td>
<td rowspan="3">6</td>
<td>&lt; 0.3 NM (556 m)</td>
</tr>
<tr class="row-even"><td>0</td>
<td>&lt; 0.5 NM (925 m)</td>
</tr>
<tr class="row-odd"><td>1 **</td>
<td>&lt; 0.6 NM (1111 m)</td>
</tr>
<tr class="row-even"><td>14</td>
<td>0</td>
<td>5</td>
<td>&lt; 1.0 NM (1852 m)</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>0</td>
<td>4</td>
<td>&lt; 2 NM (3704 m)</td>
</tr>
<tr class="row-even"><td rowspan="2">16</td>
<td>1</td>
<td>3</td>
<td>&lt; 4 NM (7408 m)</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>2</td>
<td>&lt; 8 NM (14.8 km)</td>
</tr>
<tr class="row-even"><td>17</td>
<td>0</td>
<td>1</td>
<td>&lt; 20 NM (37.0 km)</td>
</tr>
<tr class="row-odd"><td>18</td>
<td>0</td>
<td>0</td>
<td>&gt; 20 NM or Unknown</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>* NIC Supplement-A = 0</li>
<li>** NIC Supplement-A = 1</li>
</ul>
<p>In our example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">TC</span> <span class="o">-&gt;</span> <span class="mi">11</span>
<span class="n">SBnic</span> <span class="o">-&gt;</span> <span class="mi">0</span>

<span class="n">We</span> <span class="n">have</span><span class="p">:</span>
  <span class="n">NIC</span> <span class="o">-&gt;</span> <span class="mi">8</span>
</pre></div>
</div>
<p>So, what happened to the NIC Supplement-A and C? Those two bits are broadcast in
Aircraft Operational Status Message (TC=31, see Introduction page). For Surface
Position Message, you will need the combination of A and C to determine the NIC
number (note: Rc values are different from Airborne Position Messages). However,
with Supplement-B bit we are already  able to decode the NIC and Rc for airborne
positions.</p>
</div>
<div class="section" id="nac-and-hfom">
<h3>1.6.2. NAC and HFOM<a class="headerlink" href="#nac-and-hfom" title="Permalink to this headline">¶</a></h3>
<p>NAC is reported in the Airborne Velocity Message.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Junzi Sun.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/content/adsb.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>