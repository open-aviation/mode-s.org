<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

  <meta name="author" content="Junzi Sun">


  <title>The 1090MHz Riddle</title>
  <style type="text/css">code{white-space: pre;}</style>



  <link rel="stylesheet" href="../bootstrap.min.css">
  <link rel="stylesheet" href="../style.css">


<link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet">
<script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js"
  integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous">
</script>

</head>
<body>

<div class="container">

<div class="d-flex flex-row align-items-end">
	<div>
		<h1 class="title">The 1090MHz Riddle</h1>
		<div class="subtitle">An open-access book about decoding Mode-S and ADS-B data</div>
	</div>
	<div class='ml-auto chapter-nav'>
    <div class="author">By: <strong>Junzi Sun</strong> (<a href="http://junzis.com">junzis.com</a>)</div>

    <a href="http://mode-s.org" type="button"
        class="btn btn-sm btn-outline-dark btn-light">
      <i class="fas fa-angle-double-left"></i> mode-s.org
    </a>

    <a href="../book-the_1090mhz_riddle-junzi_sun.pdf"
        type="button" class="btn btn-sm btn-outline-info">
      <i class="far fa-file-pdf"></i> Download PDF
    </a>
	</div>
</div>

<hr>

<div class="row">
<div class="col-md-4 col-lg-3">
<nav>
  <h1>Chapters</h1>
  <ul>
    <li><a href="../index.html">Introduction</a></li>
    <li><a href="../adsb.html">ADS-B</a></li>
    <ul>
      <li><a href="../adsb/introduction.html">Basics</a></li>
      <li><a href="../adsb/identification.html">Aircraft Identification</a></li>
      <li><a href="../adsb/compact-position-report.html">Compact Position Reporting</a></li>
      <li><a href="../adsb/airborne-position.html">Airborne Position</a></li>
      <li><a href="../adsb/airborne-velocity.html">Airborne Velocity</a></li>
    </ul>
    <li><a href="../adsb/advance.html">Advanced ADS-B</a></li>
    <ul>
      <li><a href="../adsb/version.html">ADS-B Versions</a></li>
      <li><a href="../adsb/operation-status.html">Operation Status</a></li>
      <li><a href="../adsb/uncertainty.html">Uncertainty and Accuracy</a></li>
    </ul>
    <li><a href="../ehs.html">Enhanced Mode-S</a></li>
    <ul>
      <li><a href="../ehs/introduction.html">Basics</a></li>
      <li><a href="../ehs/bds20-identification.html">Aircraft Identification</a></li>
      <li><a href="../ehs/bds40-intention.html">Aircraft Intention</a></li>
      <li><a href="../ehs/bds50-track-n-turn.html">Track and Turn</a></li>
      <li><a href="../ehs/bds60-airspeed.html">Airspeed and Heading</a></li>
    </ul>
  </ul>
</nav>

<hr>
<nav id="TOC">
<div class="float-right">
  <a href="https://github.com/junzis/the-1090mhz-riddle/edit/master/ehs/introduction.tex"
    class='btn btn-sm btn-outline-danger'> <i class="fab fa-github-alt"></i> Edit</a>
</div>
<h1>In this page</h1>
<ul>
<li><a href="#introduction">Enhanced Mode-S Basics</a><ul>
<li><a href="#downlink-format-and-message-structure">Downlink Format and message structure</a></li>
<li><a href="#parity-and-icao-address-recovery">Parity and ICAO address recovery</a><ul>
<li><a href="#address-parity">Address Parity</a></li>
</ul></li>
<li><a href="#bds-comm-b-data-selector">BDS (Comm-B Data Selector)</a></li>
</ul></li>
</ul>
</nav>

</div>


<div class="col-md-8 col-lg-9 maintext">

<div class="float-right">
  <a href="https://github.com/junzis/the-1090mhz-riddle/edit/master/ehs/introduction.tex"
    class='btn btn-sm btn-outline-danger'> <i class="fas fa-edit"></i> Recommend edits</a>
</div>

<h1 id="introduction">Enhanced Mode-S Basics</h1>
<h2 id="downlink-format-and-message-structure">Downlink Format and message structure</h2>
<p>DF 20 and DF 21 are used for downlink messages.</p>
<p>The same as ADS-B, in all Mode-S messages, the first 5 bits contain the Downlink Format. The same identification process can be used to discover EHS messages. So the EHS messages starting bits are:</p>
<pre><code>DF20 - 10100
DF21 - 10101</code></pre>
<p>The message is structured as follows, where the digit represents the number of binary digits:</p>
<pre><code>+--------+--------+--------+--------+------------+---------+------------+
|  DF 5  |  FS 3  |  DR 5  |  UM 6  |  AC/ID 13  |  MB 56  |  AP/DP 24  |
+-----------------+--------+--------+------------+---------+------------+
|   &lt;---------+        32 bits       +--------&gt;  |


DF:     downlink format
FS:     flight status
DR:     downlink request
UM:     utility message
AC/ID:  altitude code (DF20) or identity (DF21)
MB:     message, Comm-B
AP/DP:  address parity or data parity</code></pre>
<p>Except for the DF, the first 32 bits do not contain useful information to decode the message. The exact definitions can be found in ICAO annex 10 (Aeronautical Telecommunications).</p>
<h2 id="parity-and-icao-address-recovery">Parity and ICAO address recovery</h2>
<p>Unlike ADS-B, the ICAO address is not broadcast along with the EHS messages. We will have to “decode” the ICAO address before decoding other information, and ICAO is hidden in the message and checksum.</p>
<p>Mode-S uses two types of parity checksum Address Parity (AP) and Data Parity (DP). Majority of the time Address Parity is used.</p>
<h3 id="address-parity">Address Parity</h3>
<p>For AP, the message parity field is produced by XOR ICAO with message data CRC checksum. So, to recover the ICAO bits, simply reversing the XOR process will work, shown as follows:</p>
<pre><code>+-------------------------------+  +--------------------+
|   DATA FIELD (32 OR 88 BIT)   |  |    PARITY BITS     |
+--------------+----------------+  +--------------------+
               |
               |                           XOR
               v
+--------------+-----------+       +--------------------+
|          ENCODER         |  +--&gt; | CHECKSUM (24 BITS) |
+--------------------------+       +--------------------+
                                            ||
                                   +--------------------+
                                   |   ICAO (24 BITS)   |
                                   +--------------------+</code></pre>
<p>An example:</p>
<pre><code>Message:      A0001838CA380031440000F24177

Data:         A0001838CA380031440000
Parity:                             F24177

Encode data:  CE2CA7

ICAO:    [F24177] XOR [CE2CA7] =&gt; [3C6DD0]</code></pre>
<p>For the implementation of the CRC encoder, refer to the pyModeS library <code>pyModeS.util.crc(msg, encode=True)</code></p>
<h2 id="bds-comm-b-data-selector">BDS (Comm-B Data Selector)</h2>
<p>In simple words, BDS is a number (usually a 2-digit hexadecimal) that defines the type of message we are looking at. Both ADS-B messages and other types of Mods-S messages are all assigned their distinctive BDS number. However, it is <strong>nowhere</strong> to be found in the messages.</p>
<p>When SSR interrogates an aircraft, a BDS code is included in the request message (Uplink Format - UF 4, 5, 20, or 21). This BDS code is then used by the aircraft transponder to register the type of message to be sent. But when the downlink message is transmitted, its BDS code is not included in the message (because the SSR knows what kind of message it requested). Good news for them, but challenges for us.</p>
<p>Here are some BDS codes that we are interested in, where additional parameters about an aircraft can be found:</p>
<pre><code>BDS 2,0   Aircraft identification
BDS 2,1   Aircraft and airline registration markings
BDS 4,0   Selected vertical intention
BDS 4,4   Meteorological routine air report
BDS 5,0   Track and turn report
BDS 6,0   Heading and speed report</code></pre>

<footer class="mastfoot">
  <div class="text-right">
    <p>Site maintained by <a href="https://github.com/junzis">@junzis</a>. Build with LaTeX, Pandoc, and GitHub</p>
  </div>
</footer>

</div>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-74700456-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-74700456-1');
</script>

</body>
</html>
